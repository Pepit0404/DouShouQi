<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:mylayouts="clr-namespace:AppDouShouQi.MyLayouts"
             xmlns:converters="clr-namespace:AppDouShouQi.Resources.Converters"
             xmlns:Case="clr-namespace:DouShouQiLib;assembly=DouShouQiLib"
             x:Class="AppDouShouQi.Pages.GamePage"
             Title="GamePage">
    <ContentPage.Resources>
        <converters:CaseColorConverter x:Key="CasesConverter"/>
        <converters:CaseImageConverter x:Key="CasesIConverter"/>
        <ResourceDictionary>
            <x:Double x:Key="VerticalSpacing">2</x:Double>
            <x:Double x:Key="HorizontalSpacing">2</x:Double>
            <DataTemplate x:Key="cellTemplate">
                <Grid BackgroundColor="DarkSalmon" x:DataType="Case:Case">
                    <!--<Image Source="terre.jfif" Aspect="AspectFit" HeightRequest="100" WidthRequest="100"/>-->
                    <!--<Image Source="{Binding Type, Converter={StaticResource CasesIConverter}}" Aspect="AspectFit" />-->
                    <ImageButton Source="{Binding Type, Converter={StaticResource CasesIConverter}}"
                                 Clicked="OnTapCase"/>
                    <!--<Label Text="{Binding Onthis}"
                        TextColor="Black"          
                        BackgroundColor="{Binding Type, Converter={StaticResource CasesConverter}}"
                        FontSize="Small"
                        HorizontalOptions="Fill"
                        VerticalOptions="Fill"
                        HorizontalTextAlignment="Center"
                        VerticalTextAlignment="Center">
                        <Label.GestureRecognizers>
                            <TapGestureRecognizer Tapped="OnTapCase" Buttons="Primary" />
                        </Label.GestureRecognizers>
                    </Label>-->
                </Grid>
            </DataTemplate>
        </ResourceDictionary>
    </ContentPage.Resources>

    <mylayouts:MatrixLayout 
        BindableLayout.ItemsSource="{Binding GM.Plateau.FlatBoard2d}" 
        BindableLayout.ItemTemplate="{StaticResource cellTemplate}" 
        NbColumns="{Binding GM.Plateau.height}"
        NbRows="{Binding GM.Plateau.width}"
        HorizontalSpacing="{StaticResource HorizontalSpacing}"
        VerticalSpacing="{StaticResource VerticalSpacing}"
        BackgroundColor="DarkGrey"
        HorizontalOptions="Center" VerticalOptions="Center"
        Padding="10" Margin="100"/>
    
</ContentPage>